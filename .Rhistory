knitr::opts_chunk$set(echo = TRUE)
library(reader)
library(readr)
library(tidyverse)
library(ggplot2)
canada_births_1991_2022 <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2024/2024-01-09/canada_births_1991_2022.csv')
nhl_player_births <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2024/2024-01-09/nhl_player_births.csv')
nhl_rosters <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2024/2024-01-09/nhl_rosters.csv')
nhl_teams <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2024/2024-01-09/nhl_teams.csv')
View(nhl_player_births)
births_month <- canada_births_1991_2022 |>
group_by(month) |>
aggregate(total = n())
births_month <- canada_births_1991_2022 |>
group_by(month) |>
summarise(total = n())
View(births_month)
births_month <- canada_births_1991_2022 |>
group_by(month) |>
summarise(total = sum())
View(births_month)
births_month <- canada_births_1991_2022 |>
group_by(month, birth_year) |>
summarise(total = n())
births_month <- nhl_player_births |>
group_by(month, birth_year) |>
summarise(total = n())
births_month <- nhl_player_births |>
group_by(birth_year, birth_month) |>
summarise(total = n())
View(births_month)
births_month <- nhl_player_births |>
group_by(birth_month) |>
summarise(total = n())
births_year <- nhl_player_births |>
group_by(birth_year) |>
summarise(total = n())
View(births_year)
births_year <- nhl_player_births |>
group_by(birth_year) |>
summarise(total = n()) |>
filter(births_year > 1955)
births_year <- nhl_player_births |>
group_by(birth_year) |>
summarise(total = n()) |>
filter(birth_year > 1955)
births_year <- nhl_player_births |>
mutate(decade = case_when(birth_year < 1911 & >1899 ~ "1900s",
births_year <- nhl_player_births |>
mutate(decade = case_when((birth_year < 1911 & >1899) ~ "1900s",
births_year <- nhl_player_births |>
mutate(decade = case_when(birth_year < 1911 && >1899 ~ "1900s",
births_year <- nhl_player_births |>
mutate(decade = case_when(birth_year < 1911 & >1899 ~ "1900s",
births_year <- nhl_player_births |>
mutate(decade = case_when(birth_year < 1911 & > 1899 ~ "1900s",
births_year <- nhl_player_births |>
mutate(decade = case_when(birth_year >1899 & < 1911 ~ "1900s",
births_year <- nhl_player_births |>
mutate(decade = case_when(birth_year < 1911 & >1899 ~ "1900s",
births_year <- nhl_player_births |>
mutate(decade = case_when(birth_year < 1911 & birth_year >1899 ~ "1900s",
birth_year < 1921 & birth_year >1909 ~ "1910s",
birth_year < 1931 & birth_year >1919 ~ "1920s",
birth_year < 1941 & birth_year >1939 ~ "1930s",
birth_year < 1951 & birth_year >1949 ~ "1950s",
birth_year < 1961 & birth_year >1959 ~ "1960s",
birth_year < 1971 & birth_year >1969 ~ "1970s",
birth_year < 1981 & birth_year >1979 ~ "1980s",
birth_year < 1991 & birth_year >1989 ~ "1990s",
birth_year < 2011 & birth_year >1999 ~ "2000s")) |>
group_by(birth_year) |>
summarise(total = n())
nhl_player_births <- nhl_player_births |>
mutate(decade = case_when(birth_year < 1911 & birth_year >1899 ~ "1900s",
birth_year < 1921 & birth_year >1909 ~ "1910s",
birth_year < 1931 & birth_year >1919 ~ "1920s",
birth_year < 1941 & birth_year >1939 ~ "1930s",
birth_year < 1951 & birth_year >1949 ~ "1950s",
birth_year < 1961 & birth_year >1959 ~ "1960s",
birth_year < 1971 & birth_year >1969 ~ "1970s",
birth_year < 1981 & birth_year >1979 ~ "1980s",
birth_year < 1991 & birth_year >1989 ~ "1990s",
birth_year < 2011 & birth_year >1999 ~ "2000s"))
births_year <- nhl_player_births |>
group_by(birth_year) |>
summarise(total = n())
births_decade <- nhl_player_births |>
group_by(decade) |>
summarise(total = n())
View(births_decade)
nhl_player_births <- nhl_player_births |>
mutate(decade = case_when(birth_year > 1899 & birth_year <1910 ~ "1900s",
birth_year > 1909 & birth_year <1920 ~ "1910s",
birth_year > 1919 & birth_year <1930 ~ "1920s",
birth_year > 1929 & birth_year <1940 ~ "1930s",
birth_year > 1939 & birth_year <1950 ~ "1940s",
birth_year > 1949 & birth_year <1960 ~ "1950s",
birth_year > 1959 & birth_year <1971 ~ "1960s",
birth_year > 1969 & birth_year <1981 ~ "1970s",
birth_year > 1979 & birth_year <1991 ~ "1980s",
birth_year > 1989 & birth_year <2001 ~ "1990s",
birth_year > 1999 & birth_year <2011 ~ "2000s"))
births_decade <- nhl_player_births |>
group_by(decade) |>
summarise(total = n())
nhl_player_births <- nhl_player_births |>
mutate(decade = case_when(birth_year > 1899 & birth_year <1910 ~ "1900s",
birth_year > 1909 & birth_year <1920 ~ "1910s",
birth_year > 1919 & birth_year <1930 ~ "1920s",
birth_year > 1929 & birth_year <1940 ~ "1930s",
birth_year > 1939 & birth_year <1950 ~ "1940s",
birth_year > 1949 & birth_year <1960 ~ "1950s",
birth_year > 1959 & birth_year <1971 ~ "1960s",
birth_year > 1969 & birth_year <1981 ~ "1970s",
birth_year > 1979 & birth_year <1991 ~ "1980s",
birth_year > 1989 & birth_year <2001 ~ "1990s",
birth_year > 1999 & birth_year <2011 ~ "2000s",
birth_year <1900 ~ "before 1900s"))
nhl_player_births <- nhl_player_births |>
mutate(decade = case_when(birth_year > 1899 & birth_year <1910 ~ "1900s",
birth_year > 1909 & birth_year <1920 ~ "1910s",
birth_year > 1919 & birth_year <1930 ~ "1920s",
birth_year > 1929 & birth_year <1940 ~ "1930s",
birth_year > 1939 & birth_year <1950 ~ "1940s",
birth_year > 1949 & birth_year <1960 ~ "1950s",
birth_year > 1959 & birth_year <1971 ~ "1960s",
birth_year > 1969 & birth_year <1981 ~ "1970s",
birth_year > 1979 & birth_year <1991 ~ "1980s",
birth_year > 1989 & birth_year <2001 ~ "1990s",
birth_year > 1999 & birth_year <2011 ~ "2000s",
birth_year < 1900 ~ "before 1900s"))
births_decade <- nhl_player_births |>
group_by(decade) |>
summarise(total = n())
ggplot(births_decade, aes(decase, total, fill=decade)) +
geom_bar(stat="identity") +
coord_polar(start=0) +
theme_minimal()
ggplot(births_decade, aes(decade, total, fill=decade)) +
geom_bar(stat="identity") +
coord_polar(start=0) +
theme_minimal()
births_month <- nhl_player_births |>
group_by(birth_month) |>
summarise(total = n()) |>
mutate(Month = case_when(birth_month == 1 ~ "January",
birth_month == 2 ~ "Febuary",
birth_month == 3 ~ "March",
birth_month == 4 ~ "April",
birth_month == 5 ~ "May",
birth_month == 6 ~ "June",
birth_month == 7 ~ "July",
birth_month == 8 ~ "August",
birth_month == 9 ~ "September",
birth_month == 10 ~ "October",
birth_month == 11 ~ "November",
birth_month == 12 ~ "December"))
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity") +
coord_polar(start=0) +
theme_minimal()
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
theme_minimal()
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=10) +
theme_minimal()
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
ylim(-100, 900)
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
ylim(-100, 900)
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
ylim(-200, 900)
theme_void()
theme_blank()
theme_void()
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
ylim(-200, 900) +
theme_void()
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
ylim(-200, 900) +
theme_minimal()
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
ylim(-200, 900) +
theme_minimal() +
theme(grid_lines = element_blank())
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
ylim(-200, 900) +
theme_minimal() +
theme(panel.grid =  = element_blank())
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank())
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank())
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank(),
axis.text = element_blank())
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank(),
axis.text.y = element_blank())
install.packages("png")
library(png)
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank(),
axis.text.y = element_blank()) +
annotation_raster(img)
img <- readPNG("Flag_of_Canada.png")
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank(),
axis.text.y = element_blank()) +
annotation_raster(img)
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank(),
axis.text.y = element_blank()) +
annotation_raster(img, xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
#ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank(),
axis.text.y = element_blank()) +
annotation_raster(img, xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
#ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank(),
axis.text.y = element_blank()) +
geom_tile(aes(x = category, y = value), fill = NA) +
annotation_raster(img, xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
#ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank(),
axis.text.y = element_blank()) +
geom_tile(aes(x = Month, y = total), fill = NA) +
annotation_raster(img, xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
#ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank(),
axis.text.y = element_blank()) +
geom_tile(aes(x = Month, y = total), fill = NA) +
#annotation_raster(img, xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
```
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
#ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank(),
axis.text.y = element_blank()) +
geom_tile(aes(x = Month, y = total), fill = NA) #+
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
#ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank(),
axis.text.y = element_blank()) +
geom_tile(aes(x = Month, y = total), fill = NA) +
annotation_raster(img, xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
#ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank(),
axis.text.y = element_blank()) +
geom_tile(aes(x = Month, y = total), fill = NA) #+
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank(),
axis.text.y = element_blank,
panel.background = img)
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank(),
axis.text.y = element_blank) +
annotation_custom(img_raster,
xmin = -0.05, xmax = 0.05, ymin = -0.05, ymax = 0.05)
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank(),
axis.text.y = element_blank) +
annotation_custom(img,
xmin = -0.05, xmax = 0.05, ymin = -0.05, ymax = 0.05)
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank(),
axis.text.y = element_blank)# +
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank(),
axis.text.y = element_blank)
ggplot(births_month, aes(Month, total, fill=Month)) +
geom_bar(stat="identity", show.legend = F) +
coord_polar(start=0) +
#ylim(-200, 900) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.title = element_blank(),
axis.text.y = element_blank)
